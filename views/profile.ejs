<!DOCTYPE html>
<html lang="en">
    <%- include('./partials/head.ejs') %>
    <style>
        .profile_photo img{
            height: 150px;
            width: 150px;
            border-radius: 50%;
            object-fit: cover;
            background: #dfdfdf;
        }
    </style>
<body>
    <%- include('./partials/nav.ejs') %>
    <hr class="hr" />
    <div class="container-lg">
        <div class="row justify-content-center">
            <% if(profile.profilepicture == '') {
                %>
            <div class="col-12 py-5 text-center">
                <div class="profile_photo" id=" profile_photo">
                    <img src="/random_person.jpg" class="random_person rounded-circle" style="width: 150px;"
                        alt="Avatar">
                </div> 
            </div>
            <%} else{ 
                let pp = profile.profilepicture;
                console.log(pp);
                %>
                <div class="col-12 py-5 text-center">
                    <div class="profile_photo" id="profile_photo">
                        <img src="/profile_picture/<%=pp%>" class="saved_image rounded-circle" style="width: 150px;"
                            alt="Avatar">
                    </div> 
                </div>
                <% } %>
            <form action="/upload-pp/<%=user.id%>" method="post" enctype="multipart/form-data">
                <div class="col-12">
                    <div class="row justify-content-center">
                        <div class="col-1">
                            <label for="name" class="form-label" > Name:</label> 
                        </div>
                        <div class="col-2 pb-3">
                            <input type="text" value="<%=profile.name %>" name="name" id="name" class="form-control border-primary" required>
                        </div>
                        <div class="col-12">  
                        </div>
                        <div class="col-1">
                            <label for="phonenumber" class="form-label" > Phonenumber:</label>
                        </div> 
                        <div class="col-2 pb-3">
                            <input type="text" value="<%=profile.phonenumber %>" name="phonenumber" id="phonenumber" class="form-control border-primary" required>
                        </div>
                        <div class="col-12">  
                        </div> 
    
                        <div class="col-1">
                            <label for="email" class="form-label" > Email:</label>
                        </div>  
                        <div class="col-2 pb-3">
                            <input type="email" value="<%=profile.email %>" name="email" id="email" class="form-control border-primary" required>
                        </div>
                        <div class="col-12">  
                        </div> 
                        <div class="col-3 text-end pb-3">
                            <input type="file" accept="Image/*" name="profilepicture" class="form-control file-upload-image border border-white" >
                        </div>
                        <div class="col-12">  
                        </div> 
                        <div class=" col-2 text-end">
                            <button type="submit" class="form-control file-upload-image btn btn-outline-danger"> save</button>
                        </div> 
                    </div>
                </div>
            </form>
        </div>
    </div>
    <%- include('./partials/foot.ejs') %>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous">
</script>


</body>
<script>
    const random_image = document.querySelector('.random_person')
    const saved_image = document.querySelector('.saved_image')
    input = document.querySelector('.file-upload-image');
    input.addEventListener('change', ()=> {
    saved_image.src = URL.createObjectURL(input.files[0]);
    })
     input.addEventListener('change', ()=> {
        random_image.src = URL.createObjectURL(input.files[0]);
    })
    </script>
</html>